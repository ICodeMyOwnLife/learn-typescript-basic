"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ts = require("typescript");
var transformation_1 = require("../transformation");
function replaceInText(fileName, fileText) {
    if (arguments.length === 1) {
        fileText = fileName;
        fileName = "/file.tsx";
    }
    var sourceFile = ts.createSourceFile(fileName, fileText, ts.ScriptTarget.Latest, false);
    var finalText = "";
    var lastPos = 0;
    forEachChild(sourceFile);
    if (lastPos === 0)
        return { replaced: false };
    finalText += fileText.substring(lastPos);
    return { fileText: finalText, replaced: true };
    function forEachChild(node) {
        var result = transformation_1.visitNode(node, sourceFile);
        if (result === node) {
            ts.forEachChild(node, forEachChild);
            return;
        }
        finalText += fileText.substring(lastPos, node.getStart(sourceFile));
        finalText += "\"" + result.text + "\"";
        lastPos = node.getEnd();
    }
}
exports.replaceInText = replaceInText;
